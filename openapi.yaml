openapi: 3.0.0
servers:
  - description: API Gateway
    url: http://157.245.51.170:9010
info:
  description: API Documentation for BEI IDX Portal
  version: "1.0.0"
  title: BEI IDX Portal API
tags:
  - name: user
  - name: module
paths:
# user
  /api/user/logins:
    post:
      tags:
        - user
      summary: user login
      description: |
        User login into the system
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  format: username
                  example: username
                password:
                  type: string
                  format: password
                  example: password123
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  user_role:
                    type: string
                    example: EAB
                  user_role_id:
                    type: string
                    format: uuid
                    example: c99e0e89-931b-4aff-939c-11dbfc4d22b2
                  cluster_id:
                    type: string
                    format: uuid
                    example: 71ca36ac-fa8c-4d81-94bb-a856f02764x6
                  user_type:
                    type: string
                    example: employee
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImJlNzZhM2I3LTFhMTgtNDA1ZC1hMjg1LWVkYTA1ZmI4N2RhNyIsIm5hbWUiOiJIZW5kcmFUZXN0IiwiZW1haWwiOiJIZW5kcmFUZXN0QGFxaS5jby5pZCIsInVzZXJfbmZtZSI6ImhlbmRyYXRlc3QiLCJ1c2VyX3JvbGUiOiJFQUIiLCJ1c2VyX3JvbGVfaWQiOiJjOTllMGU4OS05MzFiLTRhZmYtOTM5Yy0xMWRiZmM0ZDIyYjIiLCJjbHVzdGVyX2lkIjoiMmMwN2ZjYzItNDRjNy00ZDA5LWI1M2QtNTJlMzBhNWRlNzM4IiwidXNlcl90eXBlIjoiZW1wbG95ZWUiLCJmaXJzdF9sb2dpbiI6ZmFsc2UsInBhc3N3b3JkX2V4cGlyZWQiOiIyMDIzLTA1LTA3VDE2OjM4OjM5WiIsImV4cCI6MTY3NTgyMzYyMH0.UdxWKuPgnL1m9z57vlbgl4Jdjwsamnpi0-ZFf2fw_os
                  password_expired:
                    type: string
                    example: 2023-05-07T16:38:39Z
                  is_first_login:
                    type: boolean
                    example: false
                  code:
                    type: integer
                    example: 200
        '201':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  user_role:
                    type: string
                    example: EAB
                  user_role_id:
                    type: string
                    format: uuid
                    example: c99e0e89-931b-4aff-939c-11dbfc4d22b2
                  cluster_id:
                    type: string
                    format: uuid
                    example: 71ca36ac-fa8c-4d81-94bb-a856f02764x6
                  user_type:
                    type: string
                    example: employee
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
                  password_expired:
                    type: string
                    example: 2022-05-07T16:38:39Z
                  is_first_login:
                    type: boolean
                    example: true
                  code:
                    type: integer
                    example: 201
                  warning:
                    type: string
                    example: Password is Expired, Please Change Your Password
        '202':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  user_role:
                    type: string
                    example: EAB
                  user_role_id:
                    type: string
                    format: uuid
                    example: c99e0e89-931b-4aff-939c-11dbfc4d22b2
                  cluster_id:
                    type: string
                    format: uuid
                    example: 71ca36ac-fa8c-4d81-94bb-a856f02764x6
                  user_type:
                    type: string
                    example: employee
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
                  password_expired:
                    type: string
                    example: 2023-05-07T16:38:39Z
                  is_first_login:
                    type: boolean
                    example: true
                  code:
                    type: integer
                    example: 202
                  warning:
                    type: string
                    example: Please Change Your Password At First Login
        '400':
          $ref: '#/components/responses/400'
        '401':
          description: Unauthorized / percobaan login melebihi batas / username tidak terdaftar
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    format: number
                    example: 401
                  error:
                    type: string
                    example: Status Unauthorized
  /api/logout:
    post:
      tags:
        - user
      summary: end session
      security:
        - JWTAuth: []
      parameters:
        - in: header
          name: Authorization
          schema:
            type: string
            format: token
          required: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                  example: 70ba36ac-fa8c-4d81-94bb-a856f02769a4
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  log: 
                    type: string
                    example: Crendetials has been logout
        '400':
          $ref: '#/components/responses/DATANOTFOUND_400'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: err
  /api/change-password:
    post:
      tags:
        - user
      summary: end session
      security:
        - JWTAuth: []
      parameters:
        - in: header
          name: Authorization
          schema:
            type: string
            format: token
          required: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                  example: 70ba36ac-fa8c-4d81-94bb-a856f02769a4
                old_password:
                  type: string
                  format: password
                  example: Oldpassword123
                new_password:
                  type: string
                  format: password
                  example: Newpassword123
                confirm_password:
                  type: string
                  format: password
                  example: Newpassword123
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  message: 
                    type: string
                    example: sukses mengubah data
                  error: 
                    type: string
                    example: null
        '400':
          $ref: '#/components/responses/ERR_REQUESTBODY_400'
  /api/ping:
    get:
      tags:
        - user
      summary: test ping
      security:
        - JWTAuth: []
      parameters:
        - in: header
          name: Authorization
          schema:
            type: string
            format: token
          required: true
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: pong
  /api/user/forgot-password:
    post:
      tags:
        - user
      summary: forgot password 
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  format: email
                  example: email@gmail.com
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  user_role:
                    type: string
                    example: user role
                  user_role_id:
                    type: string
                    format: uuid
                    example: 70ba36ac-fa8c-4d81-94bb-a856f02769a4
                  cluster_id:
                    type: string
                    format: uuid
                    example: 71ca36ac-fa8c-4d81-94bb-a856f02764x6
                  user_type:
                    type: string
                    example: user type
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
                  password_expired:
                    type: string
                    example: 2023-01-02 15:04:05
                  is_first_login:
                    type: boolean
                    example: true
                  code:
                    type: integer
                    example: 200
  /api/user/change-block-status:
    post:
      tags:
        - user
      summary: change block status
      security:
        - JWTAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                  example: 70ba36ac-fa8c-4d81-94bb-a856f02769a4
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  user_role:
                    type: string
                    example: user role
                  user_role_id:
                    type: string
                    format: uuid
                    example: 70ba36ac-fa8c-4d81-94bb-a856f02769a4
                  cluster_id:
                    type: string
                    format: uuid
                    example: 71ca36ac-fa8c-4d81-94bb-a856f02764x6
                  user_type:
                    type: string
                    example: user type
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
                  password_expired:
                    type: string
                    example: 2023-01-02 15:04:05
                  is_first_login:
                    type: boolean
                    example: true
                  code:
                    type: integer
                    example: 200
        '400':
          $ref: '#/components/responses/ERR_REQUESTBODY_400'
        '500':
          description: internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: err      
  /api/user/detail:
    get:
      tags:
        - user
      summary: get user detail
      security:
        - JWTAuth: []
      parameters:
        - in: query
          name: user_role_id
          description: user_role_id as query parameter
          required: true
          schema:
            type: string
        - in: header
          name: Authorization
          schema:
            type: string
            format: token
          required: true
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    format: number
                    example: 200
                  meesage:
                    type: string
                    example: berhasil menampilkan data
                  error:
                    example: null
                  data:
                    $ref: '#/components/schemas/DataUser'
        '400':
          $ref: '#/components/responses/400'
  /api/create-user-type:
    post:
      tags:
        - user
      summary: create a new user type
      security:
        - JWTAuth: []
      parameters:
        - in: header
          name: Authorization
          schema:
            type: string
            format: token
          required: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                created_by:
                  type: string
                  format: uuid
                  example: 70ba36ac-fa8c-4d81-94bb-a856f02769a4
                type:
                  type: string
                  example: employee
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    example: 200
                  error:
                    type: string
                    example: null
        '400':
          $ref: '#/components/responses/CREATEFAILED_400'
  /api/update-user-type-by-id:
    put:
      tags:
        - user
      summary: update user type by ID
      security:
        - JWTAuth: []
      parameters:
        - in: header
          name: Authorization
          schema:
            type: string
            format: token
          required: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                  example: 70ba36ac-fa8c-4d81-94bb-a856f027n4nk
                type:
                  type: string
                  example: employee
                updated_by:
                  type: string
                  format: uuid
                  example: 70ba36ac-fa8c-4d81-94bb-a856f02769a4
      responses:
        '200':
          $ref: '#/components/responses/UPDATESUCCESS_200'
        '400':
          $ref: '#/components/responses/UPDATEFAILED_400'
  /api/delete-user-type-by-id:
    delete:
      tags:
        - user
      summary: delete user type by ID
      security:
        - JWTAuth: []
      parameters:
        - in: header
          name: Authorization
          schema:
            type: string
            format: token
          required: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                  example: 70ba36ac-fa8c-4d81-94bb-a856f027n4nk
                deleted_by:
                  type: string
                  format: uuid
                  example: 70ba36ac-fa8c-4d81-94bb-a856f02769a4
      responses:
        '200':
          $ref: '#/components/responses/UPDATESUCCESS_200'
        '400':
          $ref: '#/components/responses/UPDATEFAILED_400'
  /api/get-user-type-by-id:
    get:
      tags:
        - user
      summary: get user type by ID
      security:
        - JWTAuth: []
      parameters:
        - in: header
          name: Authorization
          schema:
            type: string
            format: token
          required: true
        - in: path
          name: id
          schema:
            type: string
            format: uuid
          required: true
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    format: number
                    example: 200
                  meesage:
                    type: string
                    example: berhasil menampilkan data
                  error:
                    example: null
                  data:
                    $ref: '#/components/schemas/DataUserType'
        '400':
          $ref: '#/components/responses/READFAILED_400'
  /api/get-all-user-type:
    get:
      tags:
        - user
      summary: get all user type
      security:
        - JWTAuth: []
      parameters:
        - in: header
          name: Authorization
          schema:
            type: string
            format: token
          required: true
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    format: number
                    example: 200
                  meesage:
                    type: string
                    example: berhasil menampilkan data
                  error:
                    example: null
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          format: uuid
                          example: 70ba36ac-fa8c-4d81-94bb-a856f027sdsf3
                        type:
                          type: string
                          format: uuid
                          example: employee
                        created_at:
                          type: string
                          example: 2023-01-02 15:04:05
                        created_by:
                          type: string
                          format: uuid
                          example: 70ba36ac-fa8c-4d81-94bb-a856f027632wm
                        updated_at:
                          type: string
                          example: 2023-01-02 15:04:05
                        updated_by:
                          type: string
                          format: uuid
                          example: 70ba36ac-fa8c-4d81-94bb-a856f027632wm
                        is_deleted:
                          type: boolean
                          example: false
        '400':
          $ref: '#/components/responses/READFAILED_400'
# module
  /api/create-module:
    post:
      tags:
        - module
      summary: create a new module
      security:
        - JWTAuth: []
      parameters:
        - in: header
          name: Authorization
          schema:
            type: string
            format: token
          required: true
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                module:
                  type: string
                  example: module
                path_module:
                  type: string
                  example: path module
                key_module:
                  type: string
                  example: key module
                created_by:
                  type: string
                  format: uuid
                  example: 70ba36ac-fa8c-4d81-94bb-a856f027632wm
      responses:
        '200':
          description: sukses menampilkan data
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: integer
                    format: number
                    example: 200
                  meesage:
                    type: string
                    example: sukses menampilkan data
                  error:
                    example: null
                  data:
                    $ref: '#/components/schemas/DataModule'
        '400':
          $ref: '#/components/responses/READFAILED_400'

components:
  schemas:
    DataUser:
      properties:
        id:
          type: integer
          example: 1
        user_role_id:
          type: string
          format: uuid
          example: 70ba36ac-fa8c-4d81-94bb-a856f02769a4
        fullname:
          type: string
          example: Full Name
        email:
          type: string
          format: email
          example: 'user@gmail.com'
        username:
          type: string
          example: username
        password:
          type: string
          example: 0cmxncnsn7aschsbcu7asocnx
        created_by:
          type: string
          example: 70ba36ac-fa8c-4d81-94bb-a856f027632wm
        created_at:
          type: string
          example: 2023-01-02 15:04:05
        updated_at:
          type: string
          example: 2023-01-02 15:04:05
      type: object
    DataUserType:
      properties:
        id:
          type: string
          format: uuid
          example: 70ba36ac-fa8c-4d81-94bb-a856f02763243
        type:
          type: string
          example: employee
        created_at:
          type: string
          example: 2023-01-02 15:04:05
        created_by:
          type: string
          format: uuid
          example: 70ba36ac-fa8c-4d81-94bb-a856f027632wm
        updated_at:
          type: string
          example: 2023-01-02 15:04:05
        updated_by:
          type: string
          format: uuid
          example: 70ba36ac-fa8c-4d81-94bb-a856f027632wm
        is_deleted:
          type: boolean
          example: false
      type: object
    DataModule:
      properties:
        id:
          type: string
          format: uuid
          example: 70ba36ac-fa8c-4d81-94bb-a856f02769a4
        module:
          type: string
          example: module
        path_module:
          type: string
          example: path module
        key_module:
          type: string
          example: key module
        created_at:
          type: string
          example: 2023-01-02 15:04:05
        created_by:
          type: string
          format: uuid
          example: 70ba36ac-fa8c-4d81-94bb-a856f027632wm
  responses:
    UPDATESUCCESS_200:
      description: sukses mengubah data
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: integer
                format: number
                example: 200
              meesage:
                type: string
                example: sukses mengubah data
              error:
                example: null
    400:
      description: gagal menampilkan data / kesalahan pada input
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: integer
                format: number
                example: 400
              meesage:
                type: string
                example: gagal menampilkan data
              error:
                example: err
    CREATEFAILED_400:
      description: gagal menambahkan data
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: integer
                format: number
                example: 400
              meesage:
                type: string
                example: gagal menambahkan data
              error:
                example: err
    READFAILED_400:
      description: gagal menampilkan data
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: integer
                format: number
                example: 400
              meesage:
                type: string
                example: gagal menampilkan data
              error:
                example: err
    UPDATEFAILED_400:
      description: gagal mengubah data
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: integer
                format: number
                example: 400
              meesage:
                type: string
                example: gagal mengubah data
              error:
                example: err
    DATANOTFOUND_400:
      description: data tidak ditemukan
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: integer
                format: number
                example: 400
              meesage:
                type: string
                example: data tidak ditemukan
              error:
                example: err
    ERR_REQUESTBODY_400:
      description: kesalahan pada request
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: integer
                format: number
                example: 400
              meesage:
                type: string
                example: kesalahan pada request
              error:
                example: err
    404:
      description: konten tidak ditemukan
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: integer
                format: number
                example: 404
              meesage:
                type: string
                example: konten tidak ditemukan
              error:
                example: err